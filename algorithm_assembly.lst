


ARM Macro Assembler    Page 1 


    1 00000000                 AREA             project, CODE, READONLY
    2 00000000         
    3 00000000                 EXPORT           MAIN        ;NEEDED LINE
    4 00000000                 ENTRY                        ;SHOWS WHEN THE COD
                                                            E STARTS
    5 00000000         
    6 00000000         
    7 00000000         MAIN                                 ;USED AS LABEL
    8 00000000         ;; Variable (Register) Definition
    9 00000000 F04F 0000       MOV              R0,#0       ;LINE COUNTER(LINES
                                                             ARE DEFINED AT THE
                                                             END)
   10 00000004 F04F 0100       MOV              R1,#0       ;COLUMN COUNTER
   11 00000008 F04F 0400       MOV              R4,#0       ;OVERALL COUNTER(GO
                                                            ES UNTILL 15*15 - 1
                                                            )
   12 0000000C F04F 5500       MOV              R5,#0x20000000 ;STACK POINTER
   13 00000010 DE00            ADR              R6,LINE1    ;ARRAY START POINTE
                                                            R
   14 00000012 F04F 0800       MOV              R8,#0       ;TEMPORARY REGISTER
                                                             FOR WIEGHT MULTIPL
                                                            ICATIONS
   15 00000016 F04F 0900       MOV              R9,#0       ;TEMPORARY REGISTER
                                                             FOR WIEGHT MULTIPL
                                                            ICATIONS
   16 0000001A         
   17 0000001A F104 0401 
                       LOOP    ADD              R4,R4,#1
   18 0000001E F5B4 7F80       CMP              R4,#256
   19 00000022 D040            BEQ              EOF         ;BRANCH TO EOF
   20 00000024 F04F 0700       MOV              R7,#0       ;ADDED RESULT FOR E
                                                            ACH BYTE
   21 00000028 F106 0601       ADD              R6,R6,#+1   ;SET THE ELEMENTS
   22 0000002C F101 0101       ADD              R1,R1,#+1
   23 00000030 2910            CMP              R1,#16
   24 00000032 D033            BEQ              NEWLINE
   25 00000034         ;COPIES FIRST ELEMENT TO THE R7
   26 00000034         ;FOR PROCESSING AND ADDS +1 TO THE
   27 00000034         ;ARRAY START POINTER - POST INDEXED
   28 00000034 EB07 0786       ADD              R7,R6,LSL#2 ;WEIGHT 4 FOR CURRE
                                                            NT ELEMNET
   29 00000038         
   30 00000038 F2A6 0712       ADD              R7,R6,#-18  ;WEIGHT 1 FOR DIAGN
                                                            OAL ELEMENT (UPPER 
                                                            LEFT)
   31 0000003C F2A6 0710       ADD              R7,R6,#-16  ;WEIGHT 1 FOR DIAGN
                                                            OAL ELEMENT (UPPER 
                                                            RIGHT)
   32 00000040 F106 0710       ADD              R7,R6,#+16  ;WEIGHT 1 FOR DIAGN
                                                            OAL ELEMENT (LOWER 
                                                            LEFT)
   33 00000044 F106 0712       ADD              R7,R6,#+18  ;WEIGHT 1 FOR DIAGN
                                                            OAL ELEMENT (LOWER 
                                                            RIGHT)
   34 00000048         
   35 00000048 F1A6 0911       SUB              R9,R6,#17
   36 0000004C 46C8            MOV              R8,R9       ;WEIGHT 2 FOR ABOVE
                                                             ELEMENT
   37 0000004E EB07 0748       ADD              R7,R8,LSL#1



ARM Macro Assembler    Page 2 


   38 00000052 F04F 0800       MOV              R8,#0
   39 00000056 F04F 0900       MOV              R9,#0
   40 0000005A         
   41 0000005A F1A6 0901       SUB              R9,R6,#1
   42 0000005E 46C8            MOV              R8,R9
   43 00000060 46C0            MOV              R8,R8       ;WEIGHT 2 FOR LEFT 
                                                            ELEMENT
   44 00000062 EB07 0748       ADD              R7,R8,LSL#1
   45 00000066 F04F 0800       MOV              R8,#0
   46 0000006A F04F 0900       MOV              R9,#0
   47 0000006E         
   48 0000006E F106 0901       ADD              R9,R6,#1
   49 00000072 46C8            MOV              R8,R9       ;WEIGHT 2 FOR RIGHT
                                                             ELEMENT
   50 00000074 EB07 0748       ADD              R7,R8,LSL#1
   51 00000078 F04F 0800       MOV              R8,#0
   52 0000007C F04F 0900       MOV              R9,#0
   53 00000080         
   54 00000080 F106 0911       ADD              R9,R6,#17
   55 00000084 46C8            MOV              R8,R9       ;WEIGHT 2 FOR BELOW
                                                             ELEMENT
   56 00000086 EB07 0748       ADD              R7,R8,LSL#1
   57 0000008A F04F 0800       MOV              R8,#0
   58 0000008E F04F 0900       MOV              R9,#0
   59 00000092         
   60 00000092 EA4F 1727       MOV              R7,R7,ASR#4
   61 00000096 F845 7B01       STR              R7,[R5],#+1 ;STORE THE AVERAGE 
                                                            PIXEL ON THE STACK 
                                                            POINTER AND INCREME
                                                            NT SP
   62 0000009A         
   63 0000009A         
   64 0000009A E7BE            B                LOOP        ;BRANCH TO LOOP
   65 0000009C         
   66 0000009C F04F 0100 
                       NEWLINE MOV              R1,#0       ;RESET THE COLUMN C
                                                            OUNTER
   67 000000A0 F106 0601       ADD              R6,R6,#+1   ;SET THE NEW LINE A
                                                            DDRESS
   68 000000A4 E7B9            B                LOOP
   69 000000A6         
   70 000000A6         
   71 000000A6 E7FE    EOF     B                EOF         ;END OF ALGORITHM  
                                                            
   72 000000A8         
   73 000000A8         
   74 000000A8 00 00 00 
              00 00 00 
              00 00 00 
              00 00 00 
              00 00 00 
              00 00    LINE0   DCB              0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
,0 
                                                            ;ZERO BLOCK
   75 000000B9 00 77 63 
              6F 8D 2B 
              00 0C 07 
              00 0A 10 
              0F 21 21 



ARM Macro Assembler    Page 3 


              1F 00    LINE1   DCB              0,119,99,111,141,43,0,12,7,0,10
,16,15,33,33,31,0
   76 000000CA 00 60 5D 
              6C 70 86 
              3A 02 00 
              09 00 00 
              0E 18 16 
              16 00    LINE2   DCB              0,96,93,108,112,134,58,2,0,9,0,
0,14,24,22,22,0
   77 000000DB 00 6E 67 
              67 6A 7B 
              78 3B 08 
              00 00 00 
              03 09 0C 
              0F 00    LINE3   DCB              0,110,103,103,106,123,120,59,8,
0,0,0,3,9,12,15,0
   78 000000EC 00 65 82 
              6F 60 65 
              7A 7D 46 
              0A 03 02 
              00 05 04 
              09 00    LINE4   DCB              0,101,130,111,96,101,122,125,70
,10,3,2,0,5,4,9,0
   79 000000FD 00 7F 67 
              65 6D 6C 
              72 7B 7C 
              4C 05 00 
              04 0A 00 
              07 00    LINE5   DCB              0,127,103,101,109,108,114,123,1
24,76,5,0,4,10,0,7,0
   80 0000010E 00 71 76 
              77 72 6D 
              77 70 74 
              87 70 1A 
              00 0D 00 
              03 00    LINE6   DCB              0,113,118,119,114,109,119,112,1
16,135,112,26,0,13,0,3,0
   81 0000011F 00 6F 74 
              76 72 6E 
              70 79 66 
              6E 8E 6A 
              1A 00 0A 
              00 00    LINE7   DCB              0,111,116,118,114,110,112,121,1
02,110,142,106,26,0,10,0,0
   82 00000130 00 6C 71 
              74 73 70 
              80 60 75 
              7C 65 81 
              76 17 00 
              11 00    LINE8   DCB              0,108,113,116,115,112,128,96,11
7,124,101,129,118,23,0,17,0
   83 00000141 00 6B 6F 
              73 73 72 
              74 77 7D 
              72 61 6D 
              7B 74 2B 
              0A 00    LINE9   DCB              0,107,111,115,115,114,116,119,1
25,114,97,109,123,116,43,10,0
   84 00000152 00 6C 6E 



ARM Macro Assembler    Page 4 


              72 73 73 
              71 77 74 
              74 77 6E 
              71 88 86 
              38 00    LINE10  DCB              0,108,110,114,115,115,113,119,1
16,116,119,110,113,136,134,56,0
   85 00000163 00 6F 6E 
              71 73 74 
              7C 6C 70 
              78 73 78 
              7C 70 8B 
              8E 00    LINE11  DCB              0,111,110,113,115,116,124,108,1
12,120,115,120,124,112,139,142,0
   86 00000174 00 73 6F 
              71 73 74 
              6E 8B 72 
              5E 7C 7A 
              68 7B 72 
              84 00    LINE12  DCB              0,115,111,113,115,116,110,139,1
14,94,124,122,104,123,114,132,0
   87 00000185 00 76 70 
              71 73 74 
              77 74 7D 
              78 67 72 
              7E 6E 65 
              6E 00    LINE13  DCB              0,118,112,113,115,116,119,116,1
25,120,103,114,126,110,101,110,0
   88 00000196 00 76 71 
              5B 75 67 
              71 71 71 
              72 73 74 
              74 75 69 
              68 00    LINE14  DCB              0,118,113,91,117,103,113,113,11
3,114,115,116,116,117,105,104,0
   89 000001A7 00 7C 75 
              5E 75 67 
              70 71 71 
              72 73 74 
              74 74 7A 
              6C 00    LINE15  DCB              0,124,117,94,117,103,112,113,11
3,114,115,116,116,116,122,108,0
   90 000001B8 00 00 00 
              00 00 00 
              00 00 00 
              00 00 00 
              00 00 00 
              00 00    LINE16  DCB              0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
,0 
                                                            ;ZERO BLOCK
   91 000001C9         
   92 000001C9                 END
Command Line: --debug --xref --cpu=Cortex-M4.fp --apcs=interwork --depend=.\alg
orithm_assembly.d -o.\algorithm_assembly.o -IC:\Keil\ARM\RV31\INC -IC:\Keil\ARM
\CMSIS\Include -IC:\Keil\ARM\Inc\ST\STM32F4xx --predefine="__EVAL SETA 1" --lis
t=.\algorithm_assembly.lst algorithm_assembly.s
